document.addEventListener("DOMContentLoaded",(()=>{if(!document.location.href.includes("plausible_analytics"))return;let e={nonceElem:document.getElementById("_wpnonce"),nonce:"",showWizardElem:document.getElementById("show_wizard"),domainNameElem:document.getElementById("domain_name"),apiTokenElem:document.getElementById("api_token"),createAPITokenElems:document.getElementsByClassName("plausible-create-api-token"),buttonElems:document.getElementsByClassName("plausible-analytics-button"),stepElems:document.getElementsByClassName("plausible-analytics-wizard-next-step"),init:function(){if(""===document.location.hash&&null!==document.getElementById("plausible-analytics-wizard")&&(document.location.hash="#welcome_slide"),null!==this.nonceElem&&(this.nonce=this.nonceElem.value),this.toggleWizardStep(),window.addEventListener("hashchange",this.toggleWizardStep),null!==this.showWizardElem&&this.showWizardElem.addEventListener("click",this.showWizard),null!==this.domainNameElem&&this.domainNameElem.addEventListener("keyup",this.disableConnectButton),null!==this.apiTokenElem&&this.apiTokenElem.addEventListener("keyup",this.disableConnectButton),this.createAPITokenElems.length>0)for(let e=0;e<this.createAPITokenElems.length;e++)this.createAPITokenElems[e].addEventListener("click",this.createAPIToken);if(this.buttonElems.length>0)for(let e=0;e<this.buttonElems.length;e++)this.buttonElems[e].addEventListener("click",this.saveOption);if(document.addEventListener("click",this.toggleOption),this.stepElems.length>0)for(let e=0;e<this.stepElems.length;e++)this.stepElems[e].addEventListener("click",this.saveOptionOnNext);this.showMessages()},toggleOption:async function(t){if(null===t.target.classList||!t.target.classList.contains("plausible-analytics-toggle"))return;const n=t.target.closest("button");let s,a;s="submit"===t.target.type?n.querySelector("span"):t.target.closest("span"),n.classList.contains("bg-indigo-600")?(n.classList.replace("bg-indigo-600","bg-gray-200"),s.classList.replace("translate-x-5","translate-x-0"),n.dataset.status="off",a=""):(n.classList.replace("bg-gray-200","bg-indigo-600"),s.classList.replace("translate-x-0","translate-x-5"),n.dataset.status="on",a="on"),"1"===n.dataset.addtlOpts&&e.toggleSection(n.value.replace("-","_"));const l=new FormData;l.append("action","plausible_analytics_toggle_option"),l.append("option_name",n.name),l.append("option_value",n.value),l.append("option_label",n.nextElementSibling.innerHTML),l.append("toggle_status",a),l.append("is_list",n.dataset.list),l.append("_nonce",e.nonce);let i=await e.ajax(l);void 0!==i.capabilities&&e.maybeDisableOptions(i.capabilities)},addField:function(e){let t=document.getElementsByClassName(e.replace("_","-")+"-field")[0].cloneNode(!0),n=document.getElementsByClassName(e.replace("_","-")+"-field").length,s=t.querySelector("input"),a=t.querySelector("a");s.value="",s.setAttribute("id",e+"["+n+"]"),s.setAttribute("name",e+"["+n+"]"),a.setAttribute("onclick",'plausibleRemoveField("'+e+"["+n+']")'),a.classList.remove("hidden"),document.getElementById(e+"_list").appendChild(t)},removeField:function(t){let n=t.replace(/\[[0-9]+]/,"").replace("_","-"),s=document.getElementsByClassName(n+"-field");document.getElementById(t).closest("."+n+"-field").remove(),e.resetListItems(s,t.replace(/\[[0-9]+]/,""))},resetListItems:function(e,t){if(null!=e&&0!==e.length)for(let n=0;n<e.length;n++){let s=e[n],a=s.querySelector("input"),l=s.querySelector("a");a.setAttribute("id",t+"["+n+"]"),a.setAttribute("name",t+"["+n+"]"),l.setAttribute("onclick",'plausibleRemoveField("'+t+"["+n+']")')}},toggleSection:function(e){let t=document.getElementById(e+"_content"),n=document.getElementById(e+"_chevron");-1!==t.className.indexOf("hidden")?(t.classList.add("block"),t.classList.remove("hidden"),null!==n&&n.classList.add("rotate-180")):(t.classList.add("hidden"),t.classList.remove("block"),null!==n&&n.classList.remove("rotate-180"))},saveOption:function(t){const n=t.target,s=n.closest(".plausible-analytics-section").querySelectorAll("input, textarea"),a=new FormData;let l=[];s.forEach((function(t){t=e.validateInput(t),l.push({name:t.name,value:t.value})})),a.append("action","plausible_analytics_save_options"),a.append("options",JSON.stringify(l)),a.append("_nonce",e.nonce),n.children.length>0&&n.children[0].classList.remove("hidden"),n.setAttribute("disabled","disabled"),e.ajax(a,n)},maybeDisableOptions:function(e){document.querySelectorAll("button[data-caps]").forEach((function(t){let n=t.dataset.caps.split(","),s=!1;n.forEach((function(t){!1===e[t]&&(s=!0)})),!0===s&&"on"===t.dataset.status&&t.dispatchEvent(new Event("click",{bubbles:!0}))}))},validateInput:function(e){return"domain_name"===e.name&&e.value.match(/^(https?:\/\/)?(www.)?/).length>0&&(e.value=e.value.replace(/^(https?:\/\/)?(www.)?/,"")),e},saveOptionOnNext:function(t){let n=document.location.hash.replace("#","");if("api_token_slide"!==n&&"domain_name_slide"!==n)return;let s=t.target.closest(".plausible-analytics-wizard-step-section").getElementsByTagName("INPUT"),a=[];for(let t of s)t=e.validateInput(t),a.push({name:t.name,value:t.value});let l=new FormData;l.append("action","plausible_analytics_save_options"),l.append("options",JSON.stringify(a)),l.append("_nonce",e.nonce),e.ajax(l).then((e=>{"api_token_slide"===n&&!0===e.success&&document.getElementById("enable_analytics_dashboard_view_stats_in_wordpress").removeAttribute("disabled")}))},disableConnectButton:function(e){let t=e.target,n=document.getElementById("connect_plausible_analytics"),s=!1;if(null===n){let e=document.location.hash;n=document.querySelector(e+" .plausible-analytics-wizard-next-step"),s=!0}null!==n&&(""===t.value?s?(n.classList+=" pointer-events-none",n.classList.replace("bg-indigo-600","bg-gray-200")):(n.disabled=!0,n.innerHTML=n.innerHTML.replace("Connected","Connect")):s?(n.classList.remove("pointer-events-none"),n.classList.replace("bg-gray-200","bg-indigo-600")):n.disabled=!1)},createAPIToken:function(e){e.preventDefault();let t=document.getElementById("domain_name").value;t=t.replaceAll("/","%2F"),window.open(`${plausible_analytics_hosted_domain}/${t}/settings/integrations?new_token=WordPress`,"_blank","location=yes,height=768,width=1024,scrollbars=yes,status=no")},showWizard:function(t){let n=new FormData;n.append("action","plausible_analytics_show_wizard"),n.append("_nonce",t.target.dataset.nonce),e.ajax(n)},toggleWizardStep:function(){if(null===document.getElementById("plausible-analytics-wizard"))return;const e=document.location.hash.substring(1).replace("_slide","");let t=document.querySelectorAll(".plausible-analytics-wizard-step"),n=document.querySelectorAll(".plausible-analytics-wizard-active-step"),s=document.querySelectorAll(".plausible-analytics-wizard-completed-step");for(let e=0;e<t.length;e++)t[e].classList.remove("hidden");for(let e=0;e<n.length;e++)n[e].classList+=" hidden";for(let e=0;e<s.length;e++)s[e].classList+=" hidden";let a=document.getElementById("active-step-"+e),l=document.getElementById("step-"+e);a.classList.remove("hidden"),l.classList+=" hidden";let i=a.dataset.completedSteps.split(",");i=i.filter((e=>e)),i.length<1||i.forEach((function(e){let t=document.getElementById("completed-step-"+e),n=document.getElementById("step-"+e);t.classList.remove("hidden"),n.classList+=" hidden"}))},ajax:function(t,n=null,s=!0){return fetch(ajaxurl,{method:"POST",body:t}).then((e=>(n&&(n.children.length>0&&(n.children[0].classList+=" hidden"),"connect_plausible_analytics"===n.id&&200===e.status?n.innerText=plausible_analytics_i18n.connected:n.removeAttribute("disabled")),(200===e.status||402===e.status)&&e.json()))).then((t=>{!0===s&&e.showMessages();let n=new CustomEvent("plausibleAjaxDone",{detail:t});return document.dispatchEvent(n),void 0!==t.data?t.data:t}))},showMessages:function(){e.fetchMessages().then((function(t){!1!==t.error?e.showMessage(t.error,"error"):!1!==t.notice?e.showMessage(t.notice,"notice"):!1!==t.success&&e.showMessage(t.success,"success"),0!==t.additional.length&&null===document.getElementById("plausible-analytics-wizard")&&(void 0!==t.additional.id&&t.additional.message?e.showAdditionalMessage(t.additional.message,t.additional.id):void 0!==t.additional.id&&""===t.additional.message&&e.removeAdditionalMessage(t.additional.id))}))},fetchMessages:function(){let t=new FormData;return t.append("action","plausible_analytics_messages"),e.ajax(t,null,!1).then((function(e){return e}))},showMessage:function(e,t="success"){"error"===t?(document.getElementById("icon-error").classList.remove("hidden"),document.getElementById("icon-success").classList.add("hidden"),document.getElementById("icon-notice").classList.add("hidden")):"notice"===t?(document.getElementById("icon-notice").classList.remove("hidden"),document.getElementById("icon-error").classList.add("hidden"),document.getElementById("icon-success").classList.add("hidden")):(document.getElementById("icon-success").classList.remove("hidden"),document.getElementById("icon-error").classList.add("hidden"),document.getElementById("icon-notice").classList.add("hidden"));let n=document.getElementById("plausible-analytics-notice");document.getElementById("plausible-analytics-notice-text").innerHTML=e,n.classList.remove("hidden"),setTimeout((function(){n.classList.replace("opacity-0","opacity-100")}),200),"error"!==t&&setTimeout((function(){n.classList.replace("opacity-100","opacity-0"),setTimeout((function(){n.classList+=" hidden"}),200)}),2e3)},showAdditionalMessage:function(e,t){let n=document.querySelector(`[name='${t}']`).closest(".plausible-analytics-group");if(n.children.length>0)for(let e=0;e<n.children.length;e++)if(n.children[e].id.includes(t))return;n.innerHTML+=e},removeAdditionalMessage:function(e){let t,n=document.querySelector(`[name="${e}"]`).closest(".plausible-analytics-group");if(n.children.length>0)for(let e=0;e<n.children.length;e++)if(n.children[e].classList.contains("plausible-analytics-hook")){t=n.children[e];break}void 0===t||t.classList.contains("plausible-analytics-persist")||n.removeChild(t)}};plausibleToggleSection=e.toggleSection,plausibleAddField=e.addField,plausibleRemoveField=e.removeField,e.init()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3hCLEVBT0FGLHdCQUF5QixTQUFVN0csR0FDbEMsSUFFSWlILEVBREFELEVBRGFqSixTQUFTeUMsY0FBYyxVQUFVUixPQUN2QkksUUFBUSw4QkFHbkMsR0FBSTRHLEVBQVUxRCxTQUFTL0QsT0FBUyxFQUMvQixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSXdILEVBQVUxRCxTQUFTL0QsT0FBUUMsSUFDOUMsR0FBSXdILEVBQVUxRCxTQUFTOUQsR0FBR1MsVUFBVUMsU0FBUyw0QkFBNkIsQ0FDekUrRyxFQUFvQkQsRUFBVTFELFNBQVM5RCxHQUV2QyxLQUNELE1BSXdCK0IsSUFBdEIwRixHQUFvQ0EsRUFBa0JoSCxVQUFVQyxTQUFTLGdDQUM1RThHLEVBQVVFLFlBQVlELEVBRXhCLEdBR0RFLHVCQUF5Qi9JLEVBQVV5QyxjQUNuQ3VHLGtCQUFvQmhKLEVBQVVzRCxTQUM5QjJGLHFCQUF1QmpKLEVBQVUrRCxZQUVqQy9ELEVBQVVXLE1BQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wbGF1c2libGUtYW5hbHl0aWNzLy4vYXNzZXRzL3NyYy9qcy9hZG1pbi9tYWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGxhdXNpYmxlIEFuYWx5dGljc1xuICpcbiAqIEFkbWluIEpTXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG5cdGlmICghZG9jdW1lbnQubG9jYXRpb24uaHJlZi5pbmNsdWRlcygncGxhdXNpYmxlX2FuYWx5dGljcycpKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IHBsYXVzaWJsZSA9IHtcblx0XHQvKipcblx0XHQgKiBQcm9wZXJ0aWVzXG5cdFx0ICovXG5cdFx0bm9uY2VFbGVtOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnX3dwbm9uY2UnKSxcblx0XHRub25jZTogJycsXG5cdFx0c2hvd1dpemFyZEVsZW06IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93X3dpemFyZCcpLFxuXHRcdGRvbWFpbk5hbWVFbGVtOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9tYWluX25hbWUnKSxcblx0XHRhcGlUb2tlbkVsZW06IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcGlfdG9rZW4nKSxcblx0XHRjcmVhdGVBUElUb2tlbkVsZW1zOiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwbGF1c2libGUtY3JlYXRlLWFwaS10b2tlbicpLFxuXHRcdGJ1dHRvbkVsZW1zOiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwbGF1c2libGUtYW5hbHl0aWNzLWJ1dHRvbicpLFxuXHRcdHN0ZXBFbGVtczogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQtbmV4dC1zdGVwJyksXG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGV2ZW50cy5cblx0XHQgKi9cblx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRpZiAoZG9jdW1lbnQubG9jYXRpb24uaGFzaCA9PT0gJycgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXVzaWJsZS1hbmFseXRpY3Mtd2l6YXJkJykgIT09IG51bGwpIHtcblx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24uaGFzaCA9ICcjd2VsY29tZV9zbGlkZSc7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLm5vbmNlRWxlbSAhPT0gbnVsbCkge1xuXHRcdFx0XHR0aGlzLm5vbmNlID0gdGhpcy5ub25jZUVsZW0udmFsdWU7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMudG9nZ2xlV2l6YXJkU3RlcCgpO1xuXG5cdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMudG9nZ2xlV2l6YXJkU3RlcCk7XG5cblx0XHRcdGlmICh0aGlzLnNob3dXaXphcmRFbGVtICE9PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMuc2hvd1dpemFyZEVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob3dXaXphcmQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGhpcy5kb21haW5OYW1lRWxlbSAhPT0gbnVsbCkge1xuXHRcdFx0XHR0aGlzLmRvbWFpbk5hbWVFbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5kaXNhYmxlQ29ubmVjdEJ1dHRvbik7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLmFwaVRva2VuRWxlbSAhPT0gbnVsbCkge1xuXHRcdFx0XHR0aGlzLmFwaVRva2VuRWxlbS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuZGlzYWJsZUNvbm5lY3RCdXR0b24pO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGhpcy5jcmVhdGVBUElUb2tlbkVsZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNyZWF0ZUFQSVRva2VuRWxlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR0aGlzLmNyZWF0ZUFQSVRva2VuRWxlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNyZWF0ZUFQSVRva2VuKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGhpcy5idXR0b25FbGVtcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5idXR0b25FbGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHRoaXMuYnV0dG9uRWxlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNhdmVPcHRpb24pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRHVlIHRvIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHRvZ2dsZXMsIGFueSBldmVudHMgYm91bmQgdG8gdGhlbSB3b3VsZCBiZSB0cmlnZ2VyZWQgdHdpY2UsIHRoYXQncyB3aHkgd2UgYmluZCBpdCB0byB0aGUgZG9jdW1lbnRzJyBjbGljaydcblx0XHRcdCAqIGV2ZW50LlxuXHRcdFx0ICovXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlT3B0aW9uKTtcblxuXHRcdFx0aWYgKHRoaXMuc3RlcEVsZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN0ZXBFbGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHRoaXMuc3RlcEVsZW1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zYXZlT3B0aW9uT25OZXh0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvKipcblx0XHRcdCAqIFJ1biBvbmNlIG9uIHBhZ2Vsb2FkLlxuXHRcdFx0ICovXG5cdFx0XHR0aGlzLnNob3dNZXNzYWdlcygpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBUb2dnbGUgT3B0aW9uIGFuZCBzdG9yZSBpbiBEQi5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBlXG5cdFx0ICovXG5cdFx0dG9nZ2xlT3B0aW9uOiBhc3luYyBmdW5jdGlvbiAoZSkge1xuXHRcdFx0LyoqXG5cdFx0XHQgKiBNYWtlIHN1cmUgZXZlbnQgdGFyZ2V0IGlzIGEgdG9nZ2xlLlxuXHRcdFx0ICovXG5cdFx0XHRpZiAoZS50YXJnZXQuY2xhc3NMaXN0ID09PSBudWxsIHx8ICFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BsYXVzaWJsZS1hbmFseXRpY3MtdG9nZ2xlJykpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBidXR0b24gPSBlLnRhcmdldC5jbG9zZXN0KCdidXR0b24nKTtcblx0XHRcdGxldCB0b2dnbGU7XG5cblx0XHRcdC8vIFRoZSBidXR0b24gZWxlbWVudCBpcyBjbGlja2VkLlxuXHRcdFx0aWYgKGUudGFyZ2V0LnR5cGUgPT09ICdzdWJtaXQnKSB7XG5cdFx0XHRcdHRvZ2dsZSA9IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBUaGUgc3BhbiBlbGVtZW50IGlzIGNsaWNrZWQuXG5cdFx0XHRcdHRvZ2dsZSA9IGUudGFyZ2V0LmNsb3Nlc3QoJ3NwYW4nKTtcblx0XHRcdH1cblxuXHRcdFx0bGV0IHRvZ2dsZVN0YXR1cztcblxuXHRcdFx0aWYgKGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2JnLWluZGlnby02MDAnKSkge1xuXHRcdFx0XHQvLyBUb2dnbGU6IG9mZlxuXHRcdFx0XHRidXR0b24uY2xhc3NMaXN0LnJlcGxhY2UoJ2JnLWluZGlnby02MDAnLCAnYmctZ3JheS0yMDAnKTtcblx0XHRcdFx0dG9nZ2xlLmNsYXNzTGlzdC5yZXBsYWNlKCd0cmFuc2xhdGUteC01JywgJ3RyYW5zbGF0ZS14LTAnKTtcblx0XHRcdFx0YnV0dG9uLmRhdGFzZXQuc3RhdHVzID0gJ29mZic7XG5cdFx0XHRcdHRvZ2dsZVN0YXR1cyA9ICcnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gVG9nZ2xlOiBvblxuXHRcdFx0XHRidXR0b24uY2xhc3NMaXN0LnJlcGxhY2UoJ2JnLWdyYXktMjAwJywgJ2JnLWluZGlnby02MDAnKTtcblx0XHRcdFx0dG9nZ2xlLmNsYXNzTGlzdC5yZXBsYWNlKCd0cmFuc2xhdGUteC0wJywgJ3RyYW5zbGF0ZS14LTUnKTtcblx0XHRcdFx0YnV0dG9uLmRhdGFzZXQuc3RhdHVzID0gJ29uJztcblx0XHRcdFx0dG9nZ2xlU3RhdHVzID0gJ29uJztcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJ1dHRvbi5kYXRhc2V0LmFkZHRsT3B0cyA9PT0gJzEnKSB7XG5cdFx0XHRcdHBsYXVzaWJsZS50b2dnbGVTZWN0aW9uKGJ1dHRvbi52YWx1ZS5yZXBsYWNlKCctJywgJ18nKSk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdhY3Rpb24nLCAncGxhdXNpYmxlX2FuYWx5dGljc190b2dnbGVfb3B0aW9uJyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9uX25hbWUnLCBidXR0b24ubmFtZSk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9uX3ZhbHVlJywgYnV0dG9uLnZhbHVlKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdvcHRpb25fbGFiZWwnLCBidXR0b24ubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVySFRNTCk7XG5cdFx0XHRmb3JtLmFwcGVuZCgndG9nZ2xlX3N0YXR1cycsIHRvZ2dsZVN0YXR1cyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnaXNfbGlzdCcsIGJ1dHRvbi5kYXRhc2V0Lmxpc3QpO1xuXHRcdFx0Zm9ybS5hcHBlbmQoJ19ub25jZScsIHBsYXVzaWJsZS5ub25jZSk7XG5cblx0XHRcdGxldCBkYXRhID0gYXdhaXQgcGxhdXNpYmxlLmFqYXgoZm9ybSk7XG5cblx0XHRcdGlmIChkYXRhLmNhcGFiaWxpdGllcyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0cGxhdXNpYmxlLm1heWJlRGlzYWJsZU9wdGlvbnMoZGF0YS5jYXBhYmlsaXRpZXMpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBBZGRzIGFuIGlucHV0IG5vZGUuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gdGFyZ2V0XG5cdFx0ICovXG5cdFx0YWRkRmllbGQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcblx0XHRcdGxldCBjbG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGFyZ2V0LnJlcGxhY2UoJ18nLCAnLScpICsgJy1maWVsZCcpWzBdLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdGxldCByb3dzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YXJnZXQucmVwbGFjZSgnXycsICctJykgKyAnLWZpZWxkJyk7XG5cdFx0XHRsZXQgY3VycmVudF9yb3cgPSByb3dzLmxlbmd0aDtcblx0XHRcdGxldCBpbnB1dCA9IGNsb25lLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG5cdFx0XHRsZXQgdHJhc2ggPSBjbG9uZS5xdWVyeVNlbGVjdG9yKCdhJyk7XG5cblx0XHRcdGlucHV0LnZhbHVlID0gJyc7XG5cdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgdGFyZ2V0ICsgJ1snICsgY3VycmVudF9yb3cgKyAnXScpO1xuXHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgdGFyZ2V0ICsgJ1snICsgY3VycmVudF9yb3cgKyAnXScpO1xuXHRcdFx0dHJhc2guc2V0QXR0cmlidXRlKCdvbmNsaWNrJywgJ3BsYXVzaWJsZVJlbW92ZUZpZWxkKFwiJyArIHRhcmdldCArICdbJyArIGN1cnJlbnRfcm93ICsgJ11cIiknKTtcblx0XHRcdHRyYXNoLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQgKyAnX2xpc3QnKS5hcHBlbmRDaGlsZChjbG9uZSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFJlbW92ZXMgYW4gaW5wdXQgbm9kZS5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSB0YXJnZXRcblx0XHQgKi9cblx0XHRyZW1vdmVGaWVsZDogZnVuY3Rpb24gKHRhcmdldCkge1xuXHRcdFx0bGV0IHJvd0NsYXNzID0gdGFyZ2V0LnJlcGxhY2UoL1xcW1swLTldK10vLCAnJykucmVwbGFjZSgnXycsICctJyk7XG5cdFx0XHRsZXQgcm93cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUocm93Q2xhc3MgKyAnLWZpZWxkJyk7XG5cdFx0XHRsZXQgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQpO1xuXHRcdFx0bGV0IGxpc3RJdGVtID0gaW5wdXQuY2xvc2VzdCgnLicgKyByb3dDbGFzcyArICctZmllbGQnKTtcblxuXHRcdFx0bGlzdEl0ZW0ucmVtb3ZlKCk7XG5cblx0XHRcdHBsYXVzaWJsZS5yZXNldExpc3RJdGVtcyhyb3dzLCB0YXJnZXQucmVwbGFjZSgvXFxbWzAtOV0rXS8sICcnKSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIE1ha2Ugc3VyZSBhbGwgaXRlbXMgaW4gYSBsaXN0IGhhdmUgcHJvcGVybHkgaW5jcmVtZW50ZWQgaWQsIG5hbWUgYW5kIG9uY2xpY2sgYXR0cmlidXRlcy5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBsaXN0SXRlbXNcblx0XHQgKiBAcGFyYW0gbGlzdFxuXHRcdCAqL1xuXHRcdHJlc2V0TGlzdEl0ZW1zOiBmdW5jdGlvbiAobGlzdEl0ZW1zLCBsaXN0KSB7XG5cdFx0XHRpZiAobGlzdEl0ZW1zID09PSBudWxsIHx8IGxpc3RJdGVtcyA9PT0gdW5kZWZpbmVkIHx8IGxpc3RJdGVtcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RJdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRsZXQgaXRlbSA9IGxpc3RJdGVtc1tpXTtcblx0XHRcdFx0bGV0IGlucHV0ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuXHRcdFx0XHRsZXQgdHJhc2ggPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcblxuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgbGlzdCArICdbJyArIGkgKyAnXScpO1xuXHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBsaXN0ICsgJ1snICsgaSArICddJyk7XG5cdFx0XHRcdHRyYXNoLnNldEF0dHJpYnV0ZSgnb25jbGljaycsICdwbGF1c2libGVSZW1vdmVGaWVsZChcIicgKyBsaXN0ICsgJ1snICsgaSArICddXCIpJyk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFRvZ2dsZXMgYSBjb2xsYXBzYWJsZSBzZWN0aW9uIGFuZCByb3RhdGVzIGEgY2hldnJvbiBpZiBpdCBleGlzdHMuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gdGFyZ2V0XG5cdFx0ICovXG5cdFx0dG9nZ2xlU2VjdGlvbjogZnVuY3Rpb24gKHRhcmdldCkge1xuXHRcdFx0bGV0IHNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQgKyAnX2NvbnRlbnQnKTtcblx0XHRcdGxldCBjaGV2cm9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0ICsgJ19jaGV2cm9uJyk7XG5cblx0XHRcdGlmIChzZWN0aW9uLmNsYXNzTmFtZS5pbmRleE9mKCdoaWRkZW4nKSAhPT0gLTEpIHtcblx0XHRcdFx0c2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdibG9jaycpO1xuXHRcdFx0XHRzZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG5cdFx0XHRcdGlmIChjaGV2cm9uICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0Y2hldnJvbi5jbGFzc0xpc3QuYWRkKCdyb3RhdGUtMTgwJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlY3Rpb24uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHRcdHNlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSgnYmxvY2snKTtcblxuXHRcdFx0XHRpZiAoY2hldnJvbiAhPT0gbnVsbCkge1xuXHRcdFx0XHRcdGNoZXZyb24uY2xhc3NMaXN0LnJlbW92ZSgncm90YXRlLTE4MCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFNhdmUgdmFsdWUgb2YgaW5wdXQgb3IgdGV4dCBhcmVhIHRvIERCLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGVcblx0XHQgKi9cblx0XHRzYXZlT3B0aW9uOiBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y29uc3QgYnV0dG9uID0gZS50YXJnZXQ7XG5cdFx0XHRjb25zdCBzZWN0aW9uID0gYnV0dG9uLmNsb3Nlc3QoJy5wbGF1c2libGUtYW5hbHl0aWNzLXNlY3Rpb24nKTtcblx0XHRcdGNvbnN0IGlucHV0cyA9IHNlY3Rpb24ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHRleHRhcmVhJyk7XG5cdFx0XHRjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG5cdFx0XHRsZXQgb3B0aW9ucyA9IFtdO1xuXG5cdFx0XHRpbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXQpIHtcblx0XHRcdFx0aW5wdXQgPSBwbGF1c2libGUudmFsaWRhdGVJbnB1dChpbnB1dCk7XG5cblx0XHRcdFx0b3B0aW9ucy5wdXNoKHtuYW1lOiBpbnB1dC5uYW1lLCB2YWx1ZTogaW5wdXQudmFsdWV9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRmb3JtLmFwcGVuZCgnYWN0aW9uJywgJ3BsYXVzaWJsZV9hbmFseXRpY3Nfc2F2ZV9vcHRpb25zJyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9ucycsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdfbm9uY2UnLCBwbGF1c2libGUubm9uY2UpO1xuXG5cdFx0XHRpZiAoYnV0dG9uLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0YnV0dG9uLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG5cdFx0XHRwbGF1c2libGUuYWpheChmb3JtLCBidXR0b24pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBEaXNhYmxlIG9wdGlvbnMgYmFzZWQgb24gdGhlIGNhcGFiaWxpdGllcyByZXRyaWV2ZWQgZnJvbSB0aGUgQVBJLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGNhcGFiaWxpdGllc1xuXHRcdCAqL1xuXHRcdG1heWJlRGlzYWJsZU9wdGlvbnM6IGZ1bmN0aW9uIChjYXBhYmlsaXRpZXMpIHtcblx0XHRcdGxldCBvcHRpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2RhdGEtY2Fwc10nKTtcblxuXHRcdFx0b3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChvcHRpb24pIHtcblx0XHRcdFx0bGV0IGNhcHMgPSBvcHRpb24uZGF0YXNldC5jYXBzLnNwbGl0KCcsJyk7XG5cdFx0XHRcdGxldCBkaXNhYmxlID0gZmFsc2U7XG5cblx0XHRcdFx0Y2Fwcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXApIHtcblx0XHRcdFx0XHRpZiAoY2FwYWJpbGl0aWVzW2NhcF0gPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRkaXNhYmxlID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChkaXNhYmxlID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0Ly8gVHJpZ2dlciBhIGNsaWNrIHRvIG1ha2Ugc3VyZSB0aGUgb3B0aW9uIGlzIGRpc2FibGVkLlxuXHRcdFx0XHRcdGlmIChvcHRpb24uZGF0YXNldC5zdGF0dXMgPT09ICdvbicpIHtcblx0XHRcdFx0XHRcdG9wdGlvbi5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2xpY2snLCB7YnViYmxlczogdHJ1ZX0pKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBDdXJyZW50bHkgb25seSB2YWxpZGF0ZXMgdGhlIGRvbWFpbl9uYW1lIGlucHV0LCBidXQgY2FuIGJlIHVzZWQgaW4gdGhlIGZ1dHVyZSBmb3Igb3RoZXIgY3VzdG9tIGlucHV0IHZhbGlkYXRpb25zLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGlucHV0XG5cdFx0ICogQHJldHVybnMgeyp9XG5cdFx0ICovXG5cdFx0dmFsaWRhdGVJbnB1dDogZnVuY3Rpb24gKGlucHV0KSB7XG5cdFx0XHQvLyBTdHJpcCBodHRwKHMpOi8vKHd3dy4pIGZyb20gZG9tYWluX25hbWUgYmVmb3JlIHNlbmRpbmcgaXQuXG5cdFx0XHRpZiAoaW5wdXQubmFtZSA9PT0gJ2RvbWFpbl9uYW1lJyAmJiBpbnB1dC52YWx1ZS5tYXRjaCgvXihodHRwcz86XFwvXFwvKT8od3d3Lik/LykubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRpbnB1dC52YWx1ZSA9IGlucHV0LnZhbHVlLnJlcGxhY2UoL14oaHR0cHM/OlxcL1xcLyk/KHd3dy4pPy8sICcnKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGlucHV0O1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBTYXZlIE9wdGlvbnMgb24gTmV4dCBjbGljayBmb3IgQVBJIFRva2VuIGFuZCBEb21haW4gTmFtZSBzbGlkZXMuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdHNhdmVPcHRpb25Pbk5leHQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRsZXQgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsICcnKTtcblxuXHRcdFx0aWYgKGhhc2ggIT09ICdhcGlfdG9rZW5fc2xpZGUnICYmIGhhc2ggIT09ICdkb21haW5fbmFtZV9zbGlkZScpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgZm9ybSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1zdGVwLXNlY3Rpb24nKTtcblx0XHRcdGxldCBpbnB1dHMgPSBmb3JtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdJTlBVVCcpO1xuXHRcdFx0bGV0IG9wdGlvbnMgPSBbXTtcblxuXHRcdFx0Zm9yIChsZXQgaW5wdXQgb2YgaW5wdXRzKSB7XG5cdFx0XHRcdGlucHV0ID0gcGxhdXNpYmxlLnZhbGlkYXRlSW5wdXQoaW5wdXQpO1xuXG5cdFx0XHRcdG9wdGlvbnMucHVzaCh7bmFtZTogaW5wdXQubmFtZSwgdmFsdWU6IGlucHV0LnZhbHVlfSk7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cblx0XHRcdGRhdGEuYXBwZW5kKCdhY3Rpb24nLCAncGxhdXNpYmxlX2FuYWx5dGljc19zYXZlX29wdGlvbnMnKTtcblx0XHRcdGRhdGEuYXBwZW5kKCdvcHRpb25zJywgSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpO1xuXHRcdFx0ZGF0YS5hcHBlbmQoJ19ub25jZScsIHBsYXVzaWJsZS5ub25jZSk7XG5cblx0XHRcdHBsYXVzaWJsZS5hamF4KGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRGlzYWJsZSBWaWV3IFN0YXRzIGJ1dHRvbiwgaWYgQVBJIHRva2VuIGlzIGVudGVyZWQgYW5kIHZhbGlkLlxuXHRcdFx0XHQgKi9cblx0XHRcdFx0aWYgKGhhc2ggPT09ICdhcGlfdG9rZW5fc2xpZGUnICYmIHJlc3BvbnNlLnN1Y2Nlc3MgPT09IHRydWUpIHtcblx0XHRcdFx0XHRsZXQgc3RhdHNfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuYWJsZV9hbmFseXRpY3NfZGFzaGJvYXJkX3ZpZXdfc3RhdHNfaW5fd29yZHByZXNzJyk7XG5cblx0XHRcdFx0XHRzdGF0c19idXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogRGlzYWJsZSBDb25uZWN0IGJ1dHRvbiBpZiBEb21haW4gTmFtZSBvciBBUEkgVG9rZW4gZmllbGQgaXMgZW1wdHkuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdGRpc2FibGVDb25uZWN0QnV0dG9uOiBmdW5jdGlvbiAoZSkge1xuXHRcdFx0bGV0IHRhcmdldCA9IGUudGFyZ2V0O1xuXHRcdFx0bGV0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0X3BsYXVzaWJsZV9hbmFseXRpY3MnKTtcblx0XHRcdGxldCBidXR0b25Jc0hyZWYgPSBmYWxzZTtcblxuXHRcdFx0aWYgKGJ1dHRvbiA9PT0gbnVsbCkge1xuXHRcdFx0XHRsZXQgc2xpZGVfaWQgPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoO1xuXHRcdFx0XHRidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNsaWRlX2lkICsgJyAucGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQtbmV4dC1zdGVwJyk7XG5cdFx0XHRcdGJ1dHRvbklzSHJlZiA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChidXR0b24gPT09IG51bGwpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGFyZ2V0LnZhbHVlICE9PSAnJykge1xuXHRcdFx0XHRpZiAoIWJ1dHRvbklzSHJlZikge1xuXHRcdFx0XHRcdGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwb2ludGVyLWV2ZW50cy1ub25lJyk7XG5cdFx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZXBsYWNlKCdiZy1ncmF5LTIwMCcsICdiZy1pbmRpZ28tNjAwJylcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFidXR0b25Jc0hyZWYpIHtcblx0XHRcdFx0YnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblx0XHRcdFx0YnV0dG9uLmlubmVySFRNTCA9IGJ1dHRvbi5pbm5lckhUTUwucmVwbGFjZSgnQ29ubmVjdGVkJywgJ0Nvbm5lY3QnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QgKz0gJyBwb2ludGVyLWV2ZW50cy1ub25lJztcblx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZXBsYWNlKCdiZy1pbmRpZ28tNjAwJywgJ2JnLWdyYXktMjAwJylcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogT3BlbiBjcmVhdGUgQVBJIHRva2VuIGRpYWxvZy5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBlXG5cdFx0ICovXG5cdFx0Y3JlYXRlQVBJVG9rZW46IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdGxldCBkb21haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9tYWluX25hbWUnKS52YWx1ZTtcblx0XHRcdGRvbWFpbiA9IGRvbWFpbi5yZXBsYWNlQWxsKCcvJywgJyUyRicpO1xuXG5cdFx0XHR3aW5kb3cub3BlbihgJHtwbGF1c2libGVfYW5hbHl0aWNzX2hvc3RlZF9kb21haW59LyR7ZG9tYWlufS9zZXR0aW5ncy9pbnRlZ3JhdGlvbnM/bmV3X3Rva2VuPVdvcmRQcmVzc2AsICdfYmxhbmsnLCAnbG9jYXRpb249eWVzLGhlaWdodD03Njgsd2lkdGg9MTAyNCxzY3JvbGxiYXJzPXllcyxzdGF0dXM9bm8nKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogU2hvdyB3aXphcmQuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdHNob3dXaXphcmQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuXHRcdFx0ZGF0YS5hcHBlbmQoJ2FjdGlvbicsICdwbGF1c2libGVfYW5hbHl0aWNzX3Nob3dfd2l6YXJkJyk7XG5cdFx0XHRkYXRhLmFwcGVuZCgnX25vbmNlJywgZS50YXJnZXQuZGF0YXNldC5ub25jZSk7XG5cblx0XHRcdHBsYXVzaWJsZS5hamF4KGRhdGEpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBUb2dnbGVzIHRoZSBhY3RpdmUvaW5hY3RpdmUvY3VycmVudCBzdGF0ZSBvZiB0aGUgc3RlcHMuXG5cdFx0ICovXG5cdFx0dG9nZ2xlV2l6YXJkU3RlcDogZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZCcpID09PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoJ19zbGlkZScsICcnKTtcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXNldCBhbGwgc3RlcHMgdG8gaW5hY3RpdmUuXG5cdFx0XHQgKi9cblx0XHRcdGxldCBhbGxTdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1zdGVwJyk7XG5cdFx0XHRsZXQgYWN0aXZlU3RlcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQtYWN0aXZlLXN0ZXAnKTtcblx0XHRcdGxldCBjb21wbGV0ZWRTdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1jb21wbGV0ZWQtc3RlcCcpO1xuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFsbFN0ZXBzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGFsbFN0ZXBzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFjdGl2ZVN0ZXBzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGFjdGl2ZVN0ZXBzW2ldLmNsYXNzTGlzdCArPSAnIGhpZGRlbic7XG5cdFx0XHR9XG5cblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY29tcGxldGVkU3RlcHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Y29tcGxldGVkU3RlcHNbaV0uY2xhc3NMaXN0ICs9ICcgaGlkZGVuJztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBNYXJrIGN1cnJlbnQgc3RlcCBhcyBhY3RpdmUuXG5cdFx0XHQgKi9cblx0XHRcdGxldCBjdXJyZW50U3RlcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmUtc3RlcC0nICsgaGFzaCk7XG5cdFx0XHRsZXQgaW5hY3RpdmVDdXJyZW50U3RlcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGVwLScgKyBoYXNoKTtcblxuXHRcdFx0Y3VycmVudFN0ZXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRpbmFjdGl2ZUN1cnJlbnRTdGVwLmNsYXNzTGlzdCArPSAnIGhpZGRlbic7XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogTWFyayBzdGVwcyBhcyBjb21wbGV0ZWQuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHR5cGUge3N0cmluZ1tdfVxuXHRcdFx0ICovXG5cdFx0XHRsZXQgY3VycmVudGx5Q29tcGxldGVkU3RlcHMgPSBjdXJyZW50U3RlcC5kYXRhc2V0LmNvbXBsZXRlZFN0ZXBzLnNwbGl0KCcsJyk7XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRmlsdGVyIGVtcHR5IGFycmF5IGVsZW1lbnRzLlxuXHRcdFx0ICogQHR5cGUge3N0cmluZ1tdfVxuXHRcdFx0ICovXG5cdFx0XHRjdXJyZW50bHlDb21wbGV0ZWRTdGVwcyA9IGN1cnJlbnRseUNvbXBsZXRlZFN0ZXBzLmZpbHRlcihuID0+IG4pO1xuXG5cdFx0XHRpZiAoY3VycmVudGx5Q29tcGxldGVkU3RlcHMubGVuZ3RoIDwgMSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGN1cnJlbnRseUNvbXBsZXRlZFN0ZXBzLmZvckVhY2goZnVuY3Rpb24gKHN0ZXApIHtcblx0XHRcdFx0bGV0IGNvbXBsZXRlZFN0ZXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcGxldGVkLXN0ZXAtJyArIHN0ZXApO1xuXHRcdFx0XHRsZXQgaW5hY3RpdmVTdGVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0ZXAtJyArIHN0ZXApO1xuXG5cdFx0XHRcdGNvbXBsZXRlZFN0ZXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRcdGluYWN0aXZlU3RlcC5jbGFzc0xpc3QgKz0gJyBoaWRkZW4nO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIERvIEFKQVggcmVxdWVzdC5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBkYXRhXG5cdFx0ICogQHBhcmFtIGJ1dHRvblxuXHRcdCAqIEBwYXJhbSBzaG93TWVzc2FnZXNcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gb2JqZWN0XG5cdFx0ICovXG5cdFx0YWpheDogZnVuY3Rpb24gKGRhdGEsIGJ1dHRvbiA9IG51bGwsIHNob3dNZXNzYWdlcyA9IHRydWUpIHtcblx0XHRcdHJldHVybiBmZXRjaChcblx0XHRcdFx0YWpheHVybCxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGJvZHk6IGRhdGEsXG5cdFx0XHRcdH1cblx0XHRcdCkudGhlbihyZXNwb25zZSA9PiB7XG5cdFx0XHRcdGlmIChidXR0b24pIHtcblx0XHRcdFx0XHRpZiAoYnV0dG9uLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGJ1dHRvbi5jaGlsZHJlblswXS5jbGFzc0xpc3QgKz0gJyBoaWRkZW4nO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChidXR0b24uaWQgPT09ICdjb25uZWN0X3BsYXVzaWJsZV9hbmFseXRpY3MnICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRcdFx0XHRidXR0b24uaW5uZXJUZXh0ID0gcGxhdXNpYmxlX2FuYWx5dGljc19pMThuLmNvbm5lY3RlZDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0YnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBXZSBzdGlsbCB3YW50IHRoZSBkYXRhLCBpZiBpdCdzIGEgUGF5bWVudCBSZXF1aXJlZCBlcnJvci5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwIHx8IHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAyKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0XHRpZiAoc2hvd01lc3NhZ2VzID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0cGxhdXNpYmxlLnNob3dNZXNzYWdlcygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bGV0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdwbGF1c2libGVBamF4RG9uZScsIHtkZXRhaWw6IHJlc3BvbnNlfSk7XG5cblx0XHRcdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cblx0XHRcdFx0aWYgKHJlc3BvbnNlLmRhdGEgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdHJldHVybiByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiByZXNwb25zZTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFNob3cgbWVzc2FnZXMgb24gc2NyZWVuLlxuXHRcdCAqL1xuXHRcdHNob3dNZXNzYWdlczogZnVuY3Rpb24gKCkge1xuXHRcdFx0bGV0IG1lc3NhZ2VzID0gcGxhdXNpYmxlLmZldGNoTWVzc2FnZXMoKTtcblxuXHRcdFx0bWVzc2FnZXMudGhlbihmdW5jdGlvbiAobWVzc2FnZXMpIHtcblx0XHRcdFx0aWYgKG1lc3NhZ2VzLmVycm9yICE9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHBsYXVzaWJsZS5zaG93TWVzc2FnZShtZXNzYWdlcy5lcnJvciwgJ2Vycm9yJyk7XG5cdFx0XHRcdH0gZWxzZSBpZiAobWVzc2FnZXMubm90aWNlICE9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHBsYXVzaWJsZS5zaG93TWVzc2FnZShtZXNzYWdlcy5ub3RpY2UsICdub3RpY2UnKTtcblx0XHRcdFx0fSBlbHNlIGlmIChtZXNzYWdlcy5zdWNjZXNzICE9PSBmYWxzZSkge1xuXHRcdFx0XHRcdHBsYXVzaWJsZS5zaG93TWVzc2FnZShtZXNzYWdlcy5zdWNjZXNzLCAnc3VjY2VzcycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKG1lc3NhZ2VzLmFkZGl0aW9uYWwubGVuZ3RoID09PSAwIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZCcpICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKG1lc3NhZ2VzLmFkZGl0aW9uYWwuaWQgIT09IHVuZGVmaW5lZCAmJiBtZXNzYWdlcy5hZGRpdGlvbmFsLm1lc3NhZ2UpIHtcblx0XHRcdFx0XHRwbGF1c2libGUuc2hvd0FkZGl0aW9uYWxNZXNzYWdlKG1lc3NhZ2VzLmFkZGl0aW9uYWwubWVzc2FnZSwgbWVzc2FnZXMuYWRkaXRpb25hbC5pZCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAobWVzc2FnZXMuYWRkaXRpb25hbC5pZCAhPT0gdW5kZWZpbmVkICYmIG1lc3NhZ2VzLmFkZGl0aW9uYWwubWVzc2FnZSA9PT0gJycpIHtcblx0XHRcdFx0XHRwbGF1c2libGUucmVtb3ZlQWRkaXRpb25hbE1lc3NhZ2UobWVzc2FnZXMuYWRkaXRpb25hbC5pZCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBGZXRjaCB0aGUgbWVzc2FnZXMgZm9yIGRpc3BsYXkuXG5cdFx0ICovXG5cdFx0ZmV0Y2hNZXNzYWdlczogZnVuY3Rpb24gKCkge1xuXHRcdFx0bGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcblx0XHRcdGRhdGEuYXBwZW5kKCdhY3Rpb24nLCAncGxhdXNpYmxlX2FuYWx5dGljc19tZXNzYWdlcycpO1xuXG5cdFx0XHRsZXQgcmVzdWx0ID0gcGxhdXNpYmxlLmFqYXgoZGF0YSwgbnVsbCwgZmFsc2UpO1xuXG5cdFx0XHRyZXR1cm4gcmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdFx0XHRcdHJldHVybiByZXNwb25zZTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBEaXNwbGF5cyBhIG5vdGljZSBvciBlcnJvciBtZXNzYWdlLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIG1lc3NhZ2Vcblx0XHQgKiBAcGFyYW0gdHlwZSBlcnJvcnx3YXJuaW5nfHN1Y2Nlc3MgRGVmYXVsdHMgdG8gc3VjY2Vzcy5cblx0XHQgKi9cblx0XHRzaG93TWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UsIHR5cGUgPSAnc3VjY2VzcycpIHtcblx0XHRcdGlmICh0eXBlID09PSAnZXJyb3InKSB7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLWVycm9yJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLXN1Y2Nlc3MnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tbm90aWNlJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHR9IGVsc2UgaWYgKHR5cGUgPT09ICdub3RpY2UnKSB7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLW5vdGljZScpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbi1lcnJvcicpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuXHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbi1zdWNjZXNzJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbi1zdWNjZXNzJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLWVycm9yJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLW5vdGljZScpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgbm90aWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXVzaWJsZS1hbmFseXRpY3Mtbm90aWNlJyk7XG5cblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF1c2libGUtYW5hbHl0aWNzLW5vdGljZS10ZXh0JykuaW5uZXJIVE1MID0gbWVzc2FnZTtcblxuXHRcdFx0bm90aWNlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0bm90aWNlLmNsYXNzTGlzdC5yZXBsYWNlKCdvcGFjaXR5LTAnLCAnb3BhY2l0eS0xMDAnKTtcblx0XHRcdH0sIDIwMClcblxuXHRcdFx0aWYgKHR5cGUgIT09ICdlcnJvcicpIHtcblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0bm90aWNlLmNsYXNzTGlzdC5yZXBsYWNlKCdvcGFjaXR5LTEwMCcsICdvcGFjaXR5LTAnKTtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdG5vdGljZS5jbGFzc0xpc3QgKz0gJyBoaWRkZW4nO1xuXHRcdFx0XHRcdH0sIDIwMClcblx0XHRcdFx0fSwgMjAwMCk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFJlbmRlcnMgYSBIVE1MIGJveCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGVuYWJsZWQgb3B0aW9uLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGh0bWxcblx0XHQgKiBAcGFyYW0gdGFyZ2V0XG5cdFx0ICovXG5cdFx0c2hvd0FkZGl0aW9uYWxNZXNzYWdlOiBmdW5jdGlvbiAoaHRtbCwgdGFyZ2V0KSB7XG5cdFx0XHRsZXQgdGFyZ2V0RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtuYW1lPScke3RhcmdldH0nXWApO1xuXHRcdFx0bGV0IGNvbnRhaW5lciA9IHRhcmdldEVsZW0uY2xvc2VzdCgnLnBsYXVzaWJsZS1hbmFseXRpY3MtZ3JvdXAnKTtcblxuXHRcdFx0aWYgKGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKGNvbnRhaW5lci5jaGlsZHJlbltpXS5pZC5pbmNsdWRlcyh0YXJnZXQpKSB7XG5cdFx0XHRcdFx0XHQvLyBUaGlzIG1lc3NhZ2UgYWxyZWFkeSBleGlzdHMuXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGNvbnRhaW5lci5pbm5lckhUTUwgKz0gaHRtbDtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogUmVtb3ZlcyB0aGUgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBib3ggd2hlbiB0aGUgb3B0aW9uIGlzIGRpc2FibGVkLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIHRhcmdldFxuXHRcdCAqL1xuXHRcdHJlbW92ZUFkZGl0aW9uYWxNZXNzYWdlOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cdFx0XHRsZXQgdGFyZ2V0RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtuYW1lPVwiJHt0YXJnZXR9XCJdYCk7XG5cdFx0XHRsZXQgY29udGFpbmVyID0gdGFyZ2V0RWxlbS5jbG9zZXN0KCcucGxhdXNpYmxlLWFuYWx5dGljcy1ncm91cCcpO1xuXHRcdFx0bGV0IGFkZGl0aW9uYWxNZXNzYWdlO1xuXG5cdFx0XHRpZiAoY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAoY29udGFpbmVyLmNoaWxkcmVuW2ldLmNsYXNzTGlzdC5jb250YWlucygncGxhdXNpYmxlLWFuYWx5dGljcy1ob29rJykpIHtcblx0XHRcdFx0XHRcdGFkZGl0aW9uYWxNZXNzYWdlID0gY29udGFpbmVyLmNoaWxkcmVuW2ldO1xuXG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGFkZGl0aW9uYWxNZXNzYWdlICE9PSB1bmRlZmluZWQgJiYgIWFkZGl0aW9uYWxNZXNzYWdlLmNsYXNzTGlzdC5jb250YWlucygncGxhdXNpYmxlLWFuYWx5dGljcy1wZXJzaXN0JykpIHtcblx0XHRcdFx0Y29udGFpbmVyLnJlbW92ZUNoaWxkKGFkZGl0aW9uYWxNZXNzYWdlKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwbGF1c2libGVUb2dnbGVTZWN0aW9uID0gcGxhdXNpYmxlLnRvZ2dsZVNlY3Rpb247XG5cdHBsYXVzaWJsZUFkZEZpZWxkID0gcGxhdXNpYmxlLmFkZEZpZWxkO1xuXHRwbGF1c2libGVSZW1vdmVGaWVsZCA9IHBsYXVzaWJsZS5yZW1vdmVGaWVsZDtcblxuXHRwbGF1c2libGUuaW5pdCgpO1xufSk7XG4iXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwibG9jYXRpb24iLCJocmVmIiwiaW5jbHVkZXMiLCJwbGF1c2libGUiLCJub25jZUVsZW0iLCJnZXRFbGVtZW50QnlJZCIsIm5vbmNlIiwic2hvd1dpemFyZEVsZW0iLCJkb21haW5OYW1lRWxlbSIsImFwaVRva2VuRWxlbSIsImNyZWF0ZUFQSVRva2VuRWxlbXMiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiYnV0dG9uRWxlbXMiLCJzdGVwRWxlbXMiLCJpbml0IiwiaGFzaCIsInRoaXMiLCJ2YWx1ZSIsInRvZ2dsZVdpemFyZFN0ZXAiLCJ3aW5kb3ciLCJzaG93V2l6YXJkIiwiZGlzYWJsZUNvbm5lY3RCdXR0b24iLCJsZW5ndGgiLCJpIiwiY3JlYXRlQVBJVG9rZW4iLCJzYXZlT3B0aW9uIiwidG9nZ2xlT3B0aW9uIiwic2F2ZU9wdGlvbk9uTmV4dCIsInNob3dNZXNzYWdlcyIsImFzeW5jIiwiZSIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYnV0dG9uIiwiY2xvc2VzdCIsInRvZ2dsZSIsInRvZ2dsZVN0YXR1cyIsInR5cGUiLCJxdWVyeVNlbGVjdG9yIiwicmVwbGFjZSIsImRhdGFzZXQiLCJzdGF0dXMiLCJhZGR0bE9wdHMiLCJ0b2dnbGVTZWN0aW9uIiwiZm9ybSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwibmFtZSIsIm5leHRFbGVtZW50U2libGluZyIsImlubmVySFRNTCIsImxpc3QiLCJkYXRhIiwiYWpheCIsInVuZGVmaW5lZCIsImNhcGFiaWxpdGllcyIsIm1heWJlRGlzYWJsZU9wdGlvbnMiLCJhZGRGaWVsZCIsImNsb25lIiwiY2xvbmVOb2RlIiwiY3VycmVudF9yb3ciLCJpbnB1dCIsInRyYXNoIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlIiwiYXBwZW5kQ2hpbGQiLCJyZW1vdmVGaWVsZCIsInJvd0NsYXNzIiwicm93cyIsInJlc2V0TGlzdEl0ZW1zIiwibGlzdEl0ZW1zIiwiaXRlbSIsInNlY3Rpb24iLCJjaGV2cm9uIiwiY2xhc3NOYW1lIiwiaW5kZXhPZiIsImFkZCIsImlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJvcHRpb25zIiwiZm9yRWFjaCIsInZhbGlkYXRlSW5wdXQiLCJwdXNoIiwiSlNPTiIsInN0cmluZ2lmeSIsImNoaWxkcmVuIiwib3B0aW9uIiwiY2FwcyIsInNwbGl0IiwiZGlzYWJsZSIsImNhcCIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsImJ1YmJsZXMiLCJtYXRjaCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwidGhlbiIsInJlc3BvbnNlIiwic3VjY2VzcyIsInJlbW92ZUF0dHJpYnV0ZSIsImJ1dHRvbklzSHJlZiIsInNsaWRlX2lkIiwiZGlzYWJsZWQiLCJwcmV2ZW50RGVmYXVsdCIsImRvbWFpbiIsInJlcGxhY2VBbGwiLCJvcGVuIiwicGxhdXNpYmxlX2FuYWx5dGljc19ob3N0ZWRfZG9tYWluIiwic3Vic3RyaW5nIiwiYWxsU3RlcHMiLCJhY3RpdmVTdGVwcyIsImNvbXBsZXRlZFN0ZXBzIiwiY3VycmVudFN0ZXAiLCJpbmFjdGl2ZUN1cnJlbnRTdGVwIiwiY3VycmVudGx5Q29tcGxldGVkU3RlcHMiLCJmaWx0ZXIiLCJuIiwic3RlcCIsImNvbXBsZXRlZFN0ZXAiLCJpbmFjdGl2ZVN0ZXAiLCJmZXRjaCIsImFqYXh1cmwiLCJtZXRob2QiLCJib2R5IiwiaWQiLCJpbm5lclRleHQiLCJwbGF1c2libGVfYW5hbHl0aWNzX2kxOG4iLCJjb25uZWN0ZWQiLCJqc29uIiwiZXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImZldGNoTWVzc2FnZXMiLCJtZXNzYWdlcyIsImVycm9yIiwic2hvd01lc3NhZ2UiLCJub3RpY2UiLCJhZGRpdGlvbmFsIiwibWVzc2FnZSIsInNob3dBZGRpdGlvbmFsTWVzc2FnZSIsInJlbW92ZUFkZGl0aW9uYWxNZXNzYWdlIiwic2V0VGltZW91dCIsImh0bWwiLCJjb250YWluZXIiLCJhZGRpdGlvbmFsTWVzc2FnZSIsInJlbW92ZUNoaWxkIiwicGxhdXNpYmxlVG9nZ2xlU2VjdGlvbiIsInBsYXVzaWJsZUFkZEZpZWxkIiwicGxhdXNpYmxlUmVtb3ZlRmllbGQiXSwic291cmNlUm9vdCI6IiJ9